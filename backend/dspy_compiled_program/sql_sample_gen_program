{
  "prog.predictor": {
    "lm": null,
    "traces": [],
    "train": [],
    "demos": [
      {
        "augmented": true,
        "QA_content": "User question: How to implement rolling upgrade in TiDB?\nAnswer: 1.    Preparation:\n  - Verify no ongoing DDL operations and ensure the cluster meets the minimum topology requirements.\n  - Stop the Drainer service if using TiDB Binlog.\n2.    Use TiUP for Upgrade:\n  - Run tiup cluster upgrade <cluster-name> <version>, following the upgrade order: PD, TiProxy (if applicable), TiFlash, TiKV, TiDB, and TiCDC.\n3.    Upgrade Process:\n  - TiUP upgrades nodes one by one, handling leader transfers automatically to minimize impact.\n  - If any issues are detected, the process halts for manual intervention.\n...\n",
        "sample": "```json\n{\n  \"no_reasonable_example\": true,\n  \"steps\": []\n}\n```"
      },
      {
        "QA_content": "User question: Does TiDB support FOREIGN KEY?\nAnswer: Yes, TiDB supports FOREIGN KEY constraints starting from version 6.6.0 as an experimental feature. However, there are key considerations:\n    1.    Experimental Status: The feature is experimental and may change or be removed in future releases.\n    2.    Performance Impact: Foreign keys can lead to performance issues, especially with large datasets.\n    3.    Implementation: FOREIGN KEY constraints can be created, modified, and viewed using standard SQL commands (e.g., CREATE TABLE, ALTER TABLE).\n    4.    Upgrade Considerations: If upgrading from a version prior to 6.6.0, foreign keys will not be automatically enforced and must be recreated.\n    5.    Caution Advised: Given the potential performance impacts and experimental status, use foreign keys cautiously in TiDB.\nIn conclusion, while supported, foreign keys in TiDB are still experimental and may have significant performance implications.\n",
        "sample": "{\"no_reasonable_example\":false,\"steps\":[{\"explanation\":\"Create a 'users' table which will be referenced by the 'orders' table via a foreign key.\",\"sql\":\"CREATE TABLE IF NOT EXISTS sample_db.users (user_id INT PRIMARY KEY, name VARCHAR(255));\"},{\"explanation\":\"Create an 'orders' table with a FOREIGN KEY referencing the 'user_id' column in the 'users' table. Ensure the foreign key constraint is specified in the table creation statement.\",\"sql\":\"CREATE TABLE IF NOT EXISTS sample_db.orders (order_id INT PRIMARY KEY, order_date DATE NOT NULL, user_id INT, FOREIGN KEY (user_id) REFERENCES sample_db.users(user_id));\"},{\"explanation\":\"Insert sample data into the 'users' table.\",\"sql\":\"INSERT INTO sample_db.users (user_id, name) VALUES (1, 'Alice'), (2, 'Bob');\"},{\"explanation\":\"Insert sample data into the 'orders' table, ensuring the 'user_id' values correspond to existing 'user_id' values in the 'users' table.\",\"sql\":\"INSERT INTO sample_db.orders (order_id, order_date, user_id) VALUES (101, '2022-01-01', 1), (102, '2022-01-02', 2);\"},{\"explanation\":\"Attempt to insert a record into the 'orders' table with a 'user_id' value that does not exist in the 'users' table. This should trigger a foreign key constraint violation.\",\"sql\":\"INSERT INTO sample_db.orders (order_id, order_date, user_id) VALUES (103, '2022-01-03', 3);\"},{\"explanation\":\"View the error message that indicates the foreign key constraint violation.\",\"sql\":\"SHOW WARNINGS;\"},{\"explanation\":\"Drop the 'orders' table to remove the foreign key constraint.\",\"sql\":\"DROP TABLE IF EXISTS sample_db.orders;\"},{\"explanation\":\"Drop the 'users' table to clean up the example.\",\"sql\":\"DROP TABLE IF EXISTS sample_db.users;\"}]}"
      }
    ],
    "signature_instructions": "You are a technical assistant at TiDB, dedicated to providing users with precise and actionable guidance. \nYour mission is to ensure that users receive not only accurate answers but also valuable learning opportunities through practical, step-by-step examples. \nTo achieve this, adhere to the following instructions:\n\n1. Understand the User's question and answer: Carefully review the user's question and answer provided. Ensure you fully grasp the technical context, the core issue, and any relevant background information.\n2. Determine the Feasibility of Providing a Complete Example:\n    - Evaluate whether a step-by-step example can be provided to help the user better understand the topic at hand. Consider the technical details involved, \n    and ensure that any example you provide is fully executable without requiring additional adjustments.\n    - Ensure the example is comprehensive, and is designed to be directly usable in TiDB Serverless.\n3. Generate and Present a Complete Example:\n    - Create a clear, detailed SQLs guide that the user can follow step-by-step. This example should include all necessary SQL commands and should be self-contained without requiring additional adjustments.\n    - **Each step should include a single SQL Query (only SQL are allowed)**. he example should be self-contained, requiring no additional adjustments or assumptions from the user. \n    Avoid combining multiple SQL commands within a single step to maintain clarity and prevent confusion.\n\n\nBy following these instructions, you will help the user not only resolve their current query but also deepen their understanding of the topic through practical application.",
    "signature_prefix": "Sample:"
  }
}